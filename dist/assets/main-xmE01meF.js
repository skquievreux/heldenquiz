(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();class c{constructor(e="/data/questions"){this.basePath=e,this.cache=new Map}async loadCategory(e){if(this.cache.has(e))return this.cache.get(e);try{const t=await fetch(`${this.basePath}/${e}.json`,{cache:"no-cache"});if(!t.ok)throw new Error(`Failed to load category: ${e}`);const s=await t.json();return this.cache.set(e,s),s}catch(t){throw console.error(`Error loading category ${e}:`,t),t}}async loadAllCategories(){const t=["teamhelden","kreativ","weltentdecker","gemeinsam"].map(s=>this.loadCategory(s));try{return(await Promise.all(t)).reduce((r,n)=>(r[n.category]=n,r),{})}catch(s){throw console.error("Error loading categories:",s),s}}async getCategoryMetadata(){const e=await this.loadAllCategories();return Object.values(e).map(t=>({category:t.category,displayName:t.displayName,icon:t.icon,questionCount:t.questions.length}))}static shuffleArray(e){const t=[...e];for(let s=t.length-1;s>0;s--){const r=Math.floor(Math.random()*(s+1));[t[s],t[r]]=[t[r],t[s]]}return t}async getRandomQuestions(e,t){const s=await this.loadCategory(e),r=c.shuffleArray(s.questions);return r.slice(0,Math.min(t,r.length))}clearCache(){this.cache.clear()}}class l{constructor(e){this.config=e,this.reset()}reset(){this.currentCategory=null,this.currentQuestions=[],this.currentQuestionIndex=0,this.correctAnswers=0,this.answers=[],this.startTime=null,this.endTime=null}startQuiz(e,t){this.reset(),this.currentCategory=e,this.currentQuestions=t,this.startTime=Date.now()}getCurrentQuestion(){return this.currentQuestionIndex>=this.currentQuestions.length?null:this.currentQuestions[this.currentQuestionIndex]}submitAnswer(e){const t=this.getCurrentQuestion();if(!t)throw new Error("No current question available");const s=e===t.correctAnswer;s&&this.correctAnswers++;const r={questionIndex:this.currentQuestionIndex,question:t.question,selectedAnswer:e,correctAnswer:t.correctAnswer,isCorrect:s,explanation:t.explanation,timestamp:Date.now()};return this.answers.push(r),r}nextQuestion(){return this.currentQuestionIndex++,this.currentQuestionIndex<this.currentQuestions.length}isQuizComplete(){return this.currentQuestionIndex>=this.currentQuestions.length}getStats(){this.isQuizComplete()&&!this.endTime&&(this.endTime=Date.now());const e=this.currentQuestions.length,t=e>0?Math.round(this.correctAnswers/e*100):0,s=this.endTime&&this.startTime?Math.round((this.endTime-this.startTime)/1e3):null;return{category:this.currentCategory,totalQuestions:e,correctAnswers:this.correctAnswers,incorrectAnswers:e-this.correctAnswers,percentage:t,duration:s,answers:this.answers,badge:this.getBadgeLevel(t)}}getBadgeLevel(e){const t=this.config.badgeThresholds||{gold:80,silver:60,bronze:40};return e>=t.gold?"gold":e>=t.silver?"silver":e>=t.bronze?"bronze":"try-again"}getProgress(){return this.currentQuestions.length===0?0:Math.round(this.currentQuestionIndex/this.currentQuestions.length*100)}export(){return JSON.stringify({currentCategory:this.currentCategory,currentQuestionIndex:this.currentQuestionIndex,correctAnswers:this.correctAnswers,answers:this.answers,startTime:this.startTime,endTime:this.endTime})}import(e){const t=JSON.parse(e);Object.assign(this,t)}}class u{constructor(e){this.config=e,this.foxImage=null,this.foxSpeech=null,this.foxImages={}}init(e,t){this.foxImage=e,this.foxSpeech=t,this.loadFoxImages()}loadFoxImages(){["t-fox-normal","t-fox-happy","t-fox-thinking","t-fox-sad"].forEach(t=>{const s=document.getElementById(t);if(s){const r=t.replace("t-fox-","");this.foxImages[r]=s.src}})}setReaction(e,t=null){this.foxImage&&this.foxImages[e]&&(this.foxImage.src=this.foxImages[e],this.foxImage.style.animation="none",setTimeout(()=>{this.foxImage.style.animation="bounce 0.5s ease"},10)),t&&this.foxSpeech&&this.speak(t)}speak(e,t=null){this.foxSpeech&&(this.foxSpeech.textContent=e,this.foxSpeech.style.opacity="0",setTimeout(()=>{this.foxSpeech.style.opacity="1"},10),t&&setTimeout(()=>{this.fadeOutSpeech()},t))}fadeOutSpeech(){this.foxSpeech&&(this.foxSpeech.style.opacity="0")}showGreeting(){const e=this.config.foxReactions||{};this.setReaction("normal",e.greeting||"Willkommen!")}showCorrectReaction(){const t=(this.config.foxReactions||{}).correct||["Richtig!"],s=this.getRandomMessage(t);this.setReaction("happy",s)}showIncorrectReaction(){const t=(this.config.foxReactions||{}).incorrect||["Nicht ganz richtig."],s=this.getRandomMessage(t);this.setReaction("sad",s)}showThinkingReaction(e){this.setReaction("thinking",`Los geht's mit der Kategorie "${e}"!`)}showResultReaction(e){const t=this.config.foxReactions||{};let s,r;e>=80?(s=t.resultGreat||"Fantastisch!",r="happy"):e>=60?(s=t.resultGood||"Gut gemacht!",r="happy"):e>=40?(s=t.resultOkay||"Nicht schlecht!",r="normal"):(s=t.resultPoor||"Versuche es nochmal!",r="thinking"),this.setReaction(r,s)}showExplanation(e){this.speak(e)}getRandomMessage(e){return!Array.isArray(e)||e.length===0?"":e[Math.floor(Math.random()*e.length)]}reset(){this.showGreeting()}}class d{constructor(){this.elements={},this.screens={}}init(){this.screens={start:document.getElementById("start-screen"),quiz:document.getElementById("quiz-screen"),result:document.getElementById("result-screen")},this.elements={questionText:document.getElementById("question-text"),answersContainer:document.getElementById("answers-container"),progressBar:document.getElementById("progress"),currentQuestion:document.getElementById("current-question"),totalQuestions:document.getElementById("total-questions"),correctAnswers:document.getElementById("correct-answers"),totalAnswered:document.getElementById("total-answered"),resultMessage:document.getElementById("result-message"),resultBadge:document.getElementById("result-badge-img")}}showScreen(e){Object.values(this.screens).forEach(t=>{t&&t.classList.remove("active")}),this.screens[e]&&this.screens[e].classList.add("active")}renderCategorySelection(e,t){const s=document.querySelector(".categories");s&&(s.innerHTML="",e.forEach(r=>{const n=document.createElement("button");n.className="category-btn",n.setAttribute("data-category",r.category),n.innerHTML=`
        <span class="emoji">${r.icon}</span>
        <span>${r.displayName}</span>
      `,n.addEventListener("click",()=>{t(r.category)}),s.appendChild(n)}))}renderQuestion(e,t,s,r){this.elements.questionText&&(this.elements.questionText.textContent=e.question),this.updateProgress(t,s),this.elements.answersContainer&&(this.elements.answersContainer.innerHTML="",e.answers.forEach((n,o)=>{const a=document.createElement("button");a.className="answer-btn",a.textContent=n,a.addEventListener("click",()=>r(o)),this.elements.answersContainer.appendChild(a)}))}updateProgress(e,t){if(this.elements.currentQuestion&&(this.elements.currentQuestion.textContent=e+1),this.elements.totalQuestions&&(this.elements.totalQuestions.textContent=t),this.elements.progressBar){const s=e/t*100;this.elements.progressBar.style.width=`${s}%`}}markAnswer(e,t){var r;const s=(r=this.elements.answersContainer)==null?void 0:r.querySelectorAll(".answer-btn");s&&(s.forEach(n=>{n.disabled=!0}),s[t]&&s[t].classList.add("correct"),e!==t&&s[e]&&s[e].classList.add("incorrect"))}renderResult(e){if(this.elements.correctAnswers&&(this.elements.correctAnswers.textContent=e.correctAnswers),this.elements.totalAnswered&&(this.elements.totalAnswered.textContent=e.totalQuestions),this.elements.resultBadge){const t=document.getElementById(`${e.badge}-badge`);t&&(this.elements.resultBadge.src=t.src,this.elements.resultBadge.alt=`${e.badge} Badge`)}this.elements.resultMessage&&(this.elements.resultMessage.textContent=this.getResultMessage(e.percentage)),this.showScreen("result")}getResultMessage(e){return e>=80?"Wow! Du bist ein echter Techero! Fantastische Leistung!":e>=60?"Gut gemacht! Du bist auf dem besten Weg, ein Techero zu werden!":e>=40?"Nicht schlecht! Mit etwas Übung wirst du noch besser!":"Das war ein guter Anfang! Versuche es noch einmal und du wirst besser werden!"}showLoading(e){console.log(`Loading: ${e}`)}showError(e){alert(`Fehler: ${e}`)}reset(){this.showScreen("start"),this.elements.progressBar&&(this.elements.progressBar.style.width="0%")}}class h{constructor(){this.config=null,this.questionLoader=null,this.quizState=null,this.foxController=null,this.renderer=null,this.categoryMetadata=[]}async init(){try{await this.loadConfig(),this.questionLoader=new c,this.quizState=new l(this.config),this.foxController=new u(this.config),this.renderer=new d,this.renderer.init(),this.foxController.init(document.getElementById("fox-image"),document.getElementById("fox-speech")),this.categoryMetadata=await this.questionLoader.getCategoryMetadata(),this.setupEventListeners(),this.foxController.showGreeting(),this.renderer.renderCategorySelection(this.categoryMetadata,e=>this.startQuiz(e)),console.log("✓ T-Fox Techero-Quiz erfolgreich initialisiert!")}catch(e){console.error("Fehler bei der Initialisierung:",e),this.renderer.showError("Das Quiz konnte nicht geladen werden.")}}async loadConfig(){try{const e=await fetch("/src/config.json");if(!e.ok)throw new Error("Config konnte nicht geladen werden");this.config=await e.json()}catch(e){console.error("Fehler beim Laden der Config:",e),this.config={questionsPerQuiz:5,badgeThresholds:{gold:80,silver:60,bronze:40},foxReactions:{}}}}setupEventListeners(){const e=document.getElementById("restart-btn");e&&e.addEventListener("click",()=>this.restartQuiz())}async startQuiz(e){try{this.renderer.showLoading(!0);const t=await this.questionLoader.getRandomQuestions(e,this.config.questionsPerQuiz);this.quizState.startQuiz(e,t);const s=this.categoryMetadata.find(n=>n.category===e),r=s?s.displayName:e;this.renderer.showScreen("quiz"),this.foxController.showThinkingReaction(r),this.showCurrentQuestion(),this.renderer.showLoading(!1)}catch(t){console.error("Fehler beim Starten des Quiz:",t),this.renderer.showError("Das Quiz konnte nicht gestartet werden."),this.renderer.showLoading(!1)}}showCurrentQuestion(){const e=this.quizState.getCurrentQuestion();if(!e){this.showResult();return}this.renderer.renderQuestion(e,this.quizState.currentQuestionIndex,this.quizState.currentQuestions.length,t=>this.handleAnswer(t))}handleAnswer(e){var s;const t=this.quizState.submitAnswer(e);this.renderer.markAnswer(t.selectedAnswer,t.correctAnswer),t.isCorrect?this.foxController.showCorrectReaction():this.foxController.showIncorrectReaction(),setTimeout(()=>{var r;this.foxController.showExplanation(t.explanation),setTimeout(()=>{this.quizState.nextQuestion()?this.showCurrentQuestion():this.showResult()},((r=this.config.timings)==null?void 0:r.explanationDuration)||3e3)},((s=this.config.timings)==null?void 0:s.answerFeedbackDelay)||1500)}showResult(){const e=this.quizState.getStats();this.renderer.renderResult(e),this.foxController.showResultReaction(e.percentage),this.saveStats(e)}saveStats(e){try{const t=JSON.parse(localStorage.getItem("quizHistory")||"[]");t.push({...e,timestamp:new Date().toISOString()}),t.length>50&&t.shift(),localStorage.setItem("quizHistory",JSON.stringify(t))}catch(t){console.error("Fehler beim Speichern der Statistiken:",t)}}restartQuiz(){this.quizState.reset(),this.foxController.reset(),this.renderer.reset()}}window.TecheroQuiz=h;window.addEventListener("DOMContentLoaded",async()=>{const i=new h;await i.init(),window.techeroQuizInstance=i});
